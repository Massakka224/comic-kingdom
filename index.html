<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fantasy RPG - Version 11</title>
<style>
  body { font-family: Arial, sans-serif; background: #111; color: #fff; padding: 1em; }
  h1, h2 { text-align: center; }
  button { width: 100%; padding: 1em; margin: 0.5em 0; font-size: 1.1em; }
  .section { display: none; }
  .section.active { display: block; }
  .box { background: #222; padding: 1em; margin: 1em 0; border-radius: 10px; }
  .item { border: 1px solid #444; padding: 10px; margin: 5px 0; cursor: pointer; }
  .item:hover { background: #333; }
  nav { position: fixed; top: 0; left: 0; right: 0; background: #111; padding: 10px; z-index: 10; }
  body { padding-top: 70px; }

  /* Charakterliste */
  .character {
    border: 1px solid #444;
    padding: 10px;
    margin: 10px 0;
    background: #222;
    border-radius: 10px;
  }
  .play { background: #2ecc71; color: #000; }
  .delete { background: #e74c3c; color: #000; }
  .create { background: #3498db; color: #000; }
</style>
</head>
<body>

<h1>Fantasy RPG</h1>

<!-- Charakterauswahl -->
<div id="characterScreen" class="box section active">
  <h2>Charakterauswahl</h2>

  <!-- LISTE -->
  <div id="characterList" style="margin-bottom:20px;"></div>

  <hr>

  <!-- ERSTELLEN -->
  <input id="charName" placeholder="Name">
  <select id="charClass">
    <option>Krieger</option>
    <option>Mage</option>
    <option>Sp√§her</option>
    <option>Nekromant</option>
  </select>

  <button class="create" onclick="createCharacter()">Neuen Charakter erstellen</button>
</div>

<!-- NAVIGATION -->
<nav>
  <button onclick="show('status')">Status</button>
  <button onclick="show('quests')">Quests</button>
  <button onclick="show('dungeon')">Dungeon</button>
  <button onclick="show('stadt')">Stadt</button>
  <button onclick="show('inventar')">Inventar</button>
  <button onclick="show('ausruestung')">Ausr√ºstung</button>
</nav>

<!-- Status -->
<div id="status" class="section">
  <h2>Status</h2>
  <div class="box">
    <p>Level: <span id="level">1</span></p>
    <p>Gold: <span id="gold">50</span></p>
    <p>Energie: <span id="energy">100</span> / <span id="maxEnergy">100</span></p>
    <p>Schokolade: <span id="schoko">1</span></p>
    <p>Bestienkristalle: <span id="kristalle">0</span></p>
    <p>Klasse: <span id="klasse">Krieger</span></p>
  </div>
</div>

<!-- Quests -->
<div id="quests" class="section">
  <h2>Quests</h2>
  <div class="box">
    <button onclick="acceptQuest()">Quest annehmen</button>
    <button onclick="finishQuest()">Quest abschlie√üen</button>
    <p id="questText">Keine aktive Quest</p>
  </div>
</div>

<!-- Dungeon -->
<div id="dungeon" class="section">
  <h2>Dungeon</h2>
  <div class="box">
    <button onclick="enterDungeon()">Dungeon betreten</button>
    <p id="dungeonText">Keine Aktion</p>
  </div>
</div>

<!-- Stadt -->
<div id="stadt" class="section">
  <h2>Stadt</h2>
  <div class="box">
    <button onclick="cityGuard()">Stadtwache (Gold)</button>
    <button onclick="fillEnergyWithChocolate()">Energie mit Schokolade auff√ºllen</button>
  </div>
</div>

<!-- Inventar -->
<div id="inventar" class="section">
  <h2>Inventar</h2>
  <div class="box" id="inventoryList">Keine Items</div>
</div>

<!-- Ausr√ºstung -->
<div id="ausruestung" class="section">
  <h2>Ausr√ºstung</h2>
  <div class="box">
    <p><b>Slots:</b></p>
    <div id="slots"></div>
  </div>
</div>

<!-- Modal -->
<div id="modal" style="display:none;">
  <div class="box">
    <h2>Item Details</h2>
    <div id="itemDetails"></div>
    <button onclick="equipItem()">Ausr√ºsten</button>
    <button onclick="unequipItem()">Ablegen</button>
    <button onclick="upgradeItem()">Verbessern</button>
    <button onclick="destroyItem()">Zerst√∂ren</button>
    <button onclick="closeModal()">Schlie√üen</button>
  </div>
</div>

<script>
  // ==========================
  // CHARAKTER SYSTEM
  // ==========================
  let characters = JSON.parse(localStorage.getItem("characters")) || [];
  let currentCharacterIndex = JSON.parse(localStorage.getItem("currentCharacterIndex"));

  function saveCharacters() {
    localStorage.setItem("characters", JSON.stringify(characters));
  }

  function saveCurrentCharacterIndex() {
    localStorage.setItem("currentCharacterIndex", JSON.stringify(currentCharacterIndex));
  }

  function renderCharacters() {
    const list = document.getElementById("characterList");
    list.innerHTML = "";

    if (characters.length === 0) {
      list.innerHTML = "<p style='opacity:0.7'>Noch keine Charaktere</p>";
      return;
    }

    characters.forEach((c, i) => {
      const div = document.createElement("div");
      div.className = "character";
      div.innerHTML = `
        <b>${c.name}</b><br>
        Klasse: ${c.class}<br>
        Level: ${c.level}<br><br>

        <button class="play" onclick="playCharacter(${i})">‚ñ∂ SPIELEN</button>
        <button class="delete" onclick="deleteCharacter(${i})">üóëÔ∏è L√∂schen</button>
      `;
      list.appendChild(div);
    });
  }

  function createCharacter() {
    const name = document.getElementById("charName").value;
    const cls = document.getElementById("charClass").value;

    if (!name) {
      alert("Bitte einen Namen eingeben.");
      return;
    }

    const char = {
      name: name,
      class: cls,
      level: 1,
      gold: 50,
      energy: 100,
      maxEnergy: 100,
      schoko: 1,
      kristalle: 0,
      inventory: [],
      equipped: { head: null, body: null, weapon: null, ring: null, boots: null }
    };

    characters.push(char);
    saveCharacters();
    renderCharacters();
    document.getElementById("charName").value = "";
  }

  function deleteCharacter(index) {
    characters.splice(index, 1);
    saveCharacters();
    renderCharacters();
  }

  function playCharacter(index) {
    currentCharacterIndex = index;
    saveCurrentCharacterIndex();
    loadCharacter();
    show("status");
  }

  function loadCharacter() {
    const c = characters[currentCharacterIndex];
    level = c.level;
    gold = c.gold;
    energy = c.energy;
    maxEnergy = c.maxEnergy;
    schoko = c.schoko;
    kristalle = c.kristalle;
    klasse = c.class;
    inventory = c.inventory;
    equipped = c.equipped;

    updateUI();
