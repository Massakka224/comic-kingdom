<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>RPG Version 8</title>
<style>
body { font-family: Arial; background:#222; color:#eee; padding:20px }
button { margin:4px; padding:6px }
.box { border:1px solid #555; padding:10px; margin:10px 0 }
.item { cursor:pointer; padding:4px }
.item:hover { background:#333 }
</style>
</head>
<body>

<h1>Fantasy RPG</h1>

<div id="charScreen" class="box"></div>
<div id="gameScreen" class="box" style="display:none"></div>

<script>
/* ---------- DATEN ---------- */
let chars = JSON.parse(localStorage.getItem("chars")) || [];
let currentChar = null;

/* ---------- START ---------- */
renderCharScreen();

/* ---------- CHAR SCREEN ---------- */
function renderCharScreen(){
 const d = document.getElementById("charScreen");
 d.innerHTML = "<h2>Charakterauswahl</h2>";

 chars.forEach((c,i)=>{
  const b = document.createElement("button");
  b.textContent = c.name+" ("+c.cls+")";
  b.onclick = ()=>startGame(i);
  d.appendChild(b);

  const del = document.createElement("button");
  del.textContent="X";
  del.onclick=()=>{chars.splice(i,1);save();renderCharScreen();}
  d.appendChild(del);
 });

 d.innerHTML += "<hr>";

 const name = document.createElement("input");
 name.placeholder="Name";

 const cls = document.createElement("select");
 ["Krieger","Magier","Assassine","Nekromant"].forEach(c=>{
  const o=document.createElement("option");
  o.textContent=c; cls.appendChild(o);
 });

 const btn = document.createElement("button");
 btn.textContent="Neuer Charakter";
 btn.onclick=()=>{
  chars.push({
   name:name.value||"Held",
   cls:cls.value,
   level:1,
   gold:0,
   inventory:[],
   equipped:null
  });
  save(); renderCharScreen();
 };

 d.append(name,cls,btn);
}

/* ---------- START GAME ---------- */
function startGame(i){
 currentChar = chars[i];
 document.getElementById("charScreen").style.display="none";
 document.getElementById("gameScreen").style.display="block";
 updateUI();
}

/* ---------- UI ---------- */
function updateUI(){
 const g = document.getElementById("gameScreen");
 g.innerHTML = `
 <h2>${currentChar.name} – ${currentChar.cls}</h2>
 Level: ${currentChar.level}<br>
 Gold: ${currentChar.gold}<br>
 Ausgerüstet: ${currentChar.equipped ? currentChar.equipped.name : "nichts"}<br><br>

 <button onclick="completeQuest()">Quest abschließen</button>

 <h3>Inventar</h3>
 <div id="inv"></div>
 `;
 renderInventory();
}

/* ---------- INVENTAR ---------- */
function renderInventory(){
 const d=document.getElementById("inv");
 d.innerHTML="";
 currentChar.inventory.forEach(it=>{
  const div=document.createElement("div");
  div.className="item";
  div.textContent=`${it.name} (+${it.power})`;
  div.onclick=()=>openItem(it);
  d.appendChild(div);
 });
}

/* ---------- ITEM ---------- */
function openItem(item){
 if(item.classReq!==currentChar.cls){
  alert("Falsche Klasse");
  return;
 }
 if(confirm(`${item.name}\nPower: ${item.power}\nAusrüsten?`)){
  currentChar.equipped=item;
  save(); updateUI();
 }
}

/* ---------- QUEST ---------- */
function completeQuest(){
 currentChar.level++;
 currentChar.gold+=10;
 currentChar.inventory.push(generateItem());
 save(); updateUI();
}

/* ---------- ITEM GENERATOR ---------- */
function generateItem(){
 const pool={
  Krieger:["Schwert","Axt"],
  Magier:["Zauberstab"],
  Assassine:["Dolch"],
  Nekromant:["Totenschädel-Stab"]
 };
 const base=pool[currentChar.cls][0];
 return{
  id:Date.now()+Math.random(),
  name:base+" des Levels "+currentChar.level,
  power:Math.floor(Math.random()*5)+1,
  classReq:currentChar.cls
 };
}

/* ---------- SAVE ---------- */
function save(){
 localStorage.setItem("chars",JSON.stringify(chars));
}
</script>

</body>
</html>
