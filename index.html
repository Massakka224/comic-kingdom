<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comic Kingdom ‚Äì Version 12.3</title>

<style>
body{
  font-family:Arial, sans-serif;
  background:#f2f2f2;
  margin:0;
  padding-top:90px;
}
nav{
  position:fixed;
  top:0;left:0;right:0;
  background:#fff;
  padding:10px;
  display:flex;
  gap:5px;
  z-index:100;
}
nav button{flex:1;padding:10px;font-size:13px}
.section{display:none;padding:15px}
.section.active{display:block}
.box{
  background:#fff;
  padding:15px;
  border-radius:10px;
  margin-bottom:15px;
}
.item{
  border:1px solid #ccc;
  padding:10px;
  margin:5px 0;
  cursor:pointer;
}
.item.equipped{
  background:#dff0d8;
  opacity:0.6;
  pointer-events:none;
}
.empty{color:#888;font-style:italic}
</style>
</head>

<body>

<nav>
<button onclick="show('status')">Status</button>
<button onclick="show('quests')">Quest</button>
<button onclick="show('stadt')">Stadt</button>
<button onclick="show('inventar')">Inventar</button>
<button onclick="show('ausruestung')">Ausr√ºstung</button>
</nav>

<div id="status" class="section active">
<div class="box">
<h2>Status</h2>
<p>Klasse: <b id="uiClass"></b></p>
<p>Level: <b id="uiLevel"></b></p>
<p>XP: <b id="uiXP"></b></p>
<p>Gold: <b id="uiGold"></b></p>
<p>Angriff: <b id="uiAtk"></b></p>
<p>Verteidigung: <b id="uiDef"></b></p>
</div>
</div>

<div id="quests" class="section">
<div class="box">
<h2>Quest</h2>
<button onclick="finishQuest()">Quest abschlie√üen</button>
<p id="questLog"></p>
</div>
</div>

<div id="stadt" class="section">
<div class="box">
<h2>Stadt</h2>
<button onclick="alert('Schmiede kommt in v13')">üè≠ Schmiede</button>
<button onclick="alert('Skillsystem kommt in v13')">üßô Magierturm</button>
<button onclick="alert('Shop kommt in v13')">üõí H√§ndler</button>
</div>
</div>

<div id="inventar" class="section">
<div class="box">
<h2>Inventar</h2>
<div id="inventoryBox"></div>
</div>
</div>

<div id="ausruestung" class="section">
<div class="box">
<h2>Ausr√ºstung</h2>
<div id="equipBox"></div>
</div>
</div>

<script>
const GAME_VERSION="12.3";

/* ===== SAVE ===== */
function load(){
  try{return JSON.parse(localStorage.getItem("ck_save"))||{}}
  catch{return {}}
}
function save(){
  localStorage.setItem("ck_save",JSON.stringify(player));
}

/* ===== PLAYER ===== */
const data=load();
const player={
  version:GAME_VERSION,
  class:data.class||"Krieger",
  level:data.level||1,
  xp:data.xp||0,
  xpMax:data.xpMax||100,
  gold:data.gold||50,
  inventory:Array.isArray(data.inventory)?data.inventory:[],
  equipped:data.equipped||{Waffe:null,Helm:null,R√ºstung:null,Ring:null},
  nextId:Number.isInteger(data.nextId)?data.nextId:Date.now()
};

/* ===== DATA ===== */
const baseStats={
  Krieger:{atk:5,def:5},
  Magier:{atk:7,def:2},
  Kundschafter:{atk:6,def:3},
  Nekromant:{atk:6,def:4}
};

const itemPools={
  Waffe:["Schwert der Ehre","Axt des Zorns","Stab der Weisheit","Dolch der Schatten"],
  Helm:["Helm des Mutes","Kapuzenhelm","Knochenkrone"],
  R√ºstung:["Plattenr√ºstung","Magierrobe","Lederr√ºstung"],
  Ring:["Ring der Kraft","Ring der Abwehr"]
};

const qualities=[
  {n:"Gew√∂hnlich",min:1,atk:1,def:1,w:50},
  {n:"Ungew√∂hnlich",min:10,atk:2,def:2,w:25},
  {n:"Selten",min:20,atk:3,def:3,w:15},
  {n:"Episch",min:40,atk:5,def:5,w:7},
  {n:"Legend√§r",min:70,atk:8,def:8,w:3}
];

const slots=["Waffe","Helm","R√ºstung","Ring"];

/* ===== NAV ===== */
function show(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* ===== ITEM ===== */
function weightedQuality(){
  const pool=[];
  qualities.filter(q=>player.level>=q.min)
    .forEach(q=>{for(let i=0;i<q.w;i++)pool.push(q)});
  return pool[Math.floor(Math.random()*pool.length)];
}

function generateItem(){
  const q=weightedQuality();
  const slot=slots[Math.floor(Math.random()*slots.length)];
  return{
    id:player.nextId++,
    name:itemPools[slot][Math.floor(Math.random()*itemPools[slot].length)],
    quality:q.n,
    atk:q.atk,
    def:q.def,
    slot
  };
}

/* ===== QUEST ===== */
function finishQuest(){
  player.xp+=40;
  player.gold+=20;
  while(player.xp>=player.xpMax){
    player.xp-=player.xpMax;
    player.level++;
    player.xpMax=Math.floor(player.xpMax*1.25);
  }
  const it=generateItem();
  player.inventory.push(it);
  questLog.innerHTML=`+40 XP<br>+20 Gold<br>Beute: <b>${it.name}</b> (${it.quality})`;
  save();updateUI();
}

/* ===== EQUIP ===== */
function equipItem(id){
  const idx=player.inventory.findIndex(i=>i.id===id);
  if(idx===-1)return;
  const it=player.inventory[idx];
  if(player.equipped[it.slot]){
    if(!confirm("Ausr√ºstung ersetzen?"))return;
    player.inventory.push(player.equipped[it.slot]);
  }
  player.inventory.splice(idx,1);
  player.equipped[it.slot]=it;
  save();updateUI();
}

function unequip(slot){
  if(player.equipped[slot]){
    player.inventory.push(player.equipped[slot]);
    player.equipped[slot]=null;
    save();updateUI();
  }
}

/* ===== UI ===== */
function calcStats(){
  const base=baseStats[player.class]||{atk:1,def:1};
  let atk=base.atk+player.level;
  let def=base.def+player.level;
  Object.values(player.equipped).forEach(i=>{
    if(i){atk+=i.atk;def+=i.def}
  });
  return{atk,def};
}

function updateUI(){
  const s=calcStats();
  uiClass.textContent=player.class;
  uiLevel.textContent=player.level;
  uiXP.textContent=`${player.xp}/${player.xpMax}`;
  uiGold.textContent=player.gold;
  uiAtk.textContent=s.atk;
  uiDef.textContent=s.def;

  inventoryBox.innerHTML="";
  if(player.inventory.length===0){
    inventoryBox.innerHTML='<p class="empty">Inventar leer</p>';
  }else{
    player.inventory.forEach(i=>{
      const d=document.createElement("div");
      d.className="item";
      d.innerHTML=`<b>${i.name}</b> (${i.quality})<br>${i.slot}`;
      d.onclick=()=>equipItem(i.id);
      inventoryBox.appendChild(d);
    });
  }

  equipBox.innerHTML="";
  slots.forEach(s=>{
    equipBox.innerHTML+=`<p>${s}: ${player.equipped[s]?.name||"leer"}
    ${player.equipped[s]?` <button onclick="unequip('${s}')">Ablegen</button>`:""}
    </p>`;
  });
}

updateUI();
</script>
</body>
</html>
